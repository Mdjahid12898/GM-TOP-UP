<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UID TOPUP [BD]</title>
    
    <!-- Firebase SDK v9 Compat -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics-compat.js"></script>
    
    <style>
        * {margin:0;padding:0;box-sizing:border-box;font-family:'SolaimanLipi',Arial,sans-serif}
        body {background:#000;color:#fff;min-height:100vh;padding:10px 0}
        .container {max-width:460px;margin:10px auto;background:rgba(20,20,30,0.95);border-radius:20px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.8);border:1px solid #333}
        .header {background:linear-gradient(135deg,#ff1b6b,#e91e63);padding:20px;text-align:center;position:relative}
        .header img {height:70px;filter:drop-shadow(0 0 10px rgba(255,255,255,0.5))}
        .header h1 {font-size:26px;margin-top:10px;font-weight:bold;text-shadow:0 2px 10px rgba(0,0,0,0.5)}
        .lang-select {position:absolute;top:15px;left:15px;background:rgba(0,0,0,0.5);padding:8px 18px;border-radius:30px;font-size:14px}
        .step {padding:25px}
        .step-title {background:#e91e63;color:#fff;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;float:left;margin-right:12px;box-shadow:0 0 15px rgba(233,30,99,0.6)}
        .step h2 {font-size:20px;margin-bottom:20px;overflow:hidden;padding-top:5px}
        .packages {display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:10px}
        .pkg {background:rgba(255,255,255,0.08);border:2px solid transparent;border-radius:16px;padding:18px 10px;text-align:center;cursor:pointer;transition:all .4s;position:relative;overflow:hidden}
        .pkg::before {content:'';position:absolute;inset:0;border:2px solid #e91e63;border-radius:16px;opacity:0;transition:all .4s}
        .pkg.selected::before,.pkg:hover::before {opacity:1;box-shadow:0 0 20px #e91e63}
        .pkg:hover,.pkg.selected {background:rgba(233,30,99,0.2);transform:translateY(-6px) scale(1.03);box-shadow:0 10px 25px rgba(233,30,99,0.4)}
        .pkg .diamond {font-size:17px;font-weight:bold;margin-bottom:5px}
        .pkg .price {font-size:22px;color:#ff1744;font-weight:bold;text-shadow:0 0 10px rgba(255,23,68,0.6)}
        .input-box {margin-top:25px}
        .input-box input {width:100%;padding:18px;border-radius:16px;border:2px solid #444;background:rgba(255,255,255,0.1);color:#fff;font-size:18px;text-align:center;transition:all .3s}
        .input-box input:focus {outline:none;border-color:#e91e63;box-shadow:0 0 20px rgba(233,30,99,0.5);background:rgba(255,255,255,0.15)}
        .payment-options {display:flex;justify-content:center;gap:20px;margin:25px 0}
        .payment-option {cursor:pointer;transition:all .3s}
        .payment-option.selected {transform:scale(1.1);box-shadow:0 0 20px rgba(233,30,99,0.7);border-radius:14px}
        .payment-options img {height:60px;background:#fff;padding:10px;border-radius:14px;box-shadow:0 5px 15px rgba(0,0,0,0.3)}
        .pay-btn {background:linear-gradient(135deg,#ff1b6b,#e91e63);color:#fff;border:none;padding:18px;width:100%;border-radius:16px;font-size:20px;font-weight:bold;cursor:pointer;transition:all .3s;box-shadow:0 8px 20px rgba(233,30,99,0.4)}
        .pay-btn:hover {transform:translateY(-4px);box-shadow:0 15px 30px rgba(233,30,99,0.6)}
        .description {background:rgba(0,0,0,0.4);padding:25px;font-size:14.5px;line-height:1.8;border-top:1px solid #333}
        .description ul {padding-left:20px}
        .description li {margin:10px 0}
        .info-circle {position:fixed;right:20px;bottom:25px;background:linear-gradient(135deg,#ff1b6b,#e91e63);color:#fff;width:65px;height:65px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;box-shadow:0 0 25px rgba(233,30,99,0.7);z-index:999;animation:pulse 2s infinite}
        @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(233,30,99,0.7)}70%{box-shadow:0 0 0 15px rgba(233,30,99,0)}100%{box-shadow:0 0 0 0 rgba(233,30,99,0)}}
        .support-btn {position:fixed;left:20px;bottom:25px;background:linear-gradient(135deg,#0088cc,#0077b5);color:#fff;width:65px;height:65px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 0 25px rgba(0,136,204,0.7);z-index:999}
        .support-btn img {width:35px;height:35px}
        .modal {display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:1000;overflow-y:auto}
        .modal-content {background:rgba(30,30,40,0.95);margin:5% auto;padding:30px;border-radius:20px;width:90%;max-width:500px;border:2px solid #e91e63;box-shadow:0 0 50px rgba(233,30,99,0.5)}
        .modal-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}
        .modal-header h2 {color:#e91e63;font-size:24px}
        .close-btn {background:none;border:none;color:#fff;font-size:30px;cursor:pointer;transition:all .3s}
        .close-btn:hover {color:#e91e63;transform:scale(1.2)}
        .payment-method {background:rgba(255,255,255,0.1);padding:20px;border-radius:16px;margin-bottom:20px;text-align:center}
        .payment-method img {height:50px;margin-bottom:10px}
        .payment-method h3 {margin-bottom:15px;color:#e91e63}
        .payment-details {background:rgba(0,0,0,0.4);padding:20px;border-radius:16px;margin-bottom:20px}
        .payment-details p {margin:10px 0;font-size:16px}
        .tx-input {width:100%;padding:15px;border-radius:16px;border:2px solid #444;background:rgba(255,255,255,0.1);color:#fff;font-size:16px;margin-top:10px;text-align:center}
        .tx-input:focus {outline:none;border-color:#e91e63;box-shadow:0 0 15px rgba(233,30,99,0.5)}
        .confirm-btn {background:linear-gradient(135deg,#4CAF50,#45a049);color:#fff;border:none;padding:15px;width:100%;border-radius:16px;font-size:18px;font-weight:bold;cursor:pointer;transition:all .3s;margin-top:15px}
        .confirm-btn:hover {transform:translateY(-3px);box-shadow:0 10px 20px rgba(76,175,80,0.4)}
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="https://uploads.onecompiler.io/42weeh2u8/43hydt8zq/1000017823.jpg" alt="Logo">
        <h1>UID TOPUP [BD]</h1>
    </div>

    <div class="step"><div class="step-title">1</div><h2>Select Recharge</h2>
        <div class="packages" id="packages-container"></div>
    </div>

    <div class="step"><div class="step-title">2</div><h2>Account Info</h2>
        <div class="input-box"><input type="text" id="player-id" placeholder="এখানে আপনার Player ID লিখুন" required></div>
    </div>

    <div class="step"><div class="step-title">3</div><h2>Select Payment</h2>
        <div class="payment-options">
            <div class="payment-option" onclick="selectPayment('bkash')"><img src="https://uploads.onecompiler.io/42weeh2u8/43hsrp87q/download.jpg" alt="bKash"></div>
            <div class="payment-option" onclick="selectPayment('nagad')"><img src="https://uploads.onecompiler.io/42weeh2u8/43hsrp87q/download.png" alt="Nagad"></div>
        </div>
        <button class="pay-btn" onclick="openPaymentModal()">PAY NOW</button>
    </div>

    <div class="description">
        <div class="step-title">4</div><h2>Description</h2>
        <ul>
            <li>Player ID ভুল হলে ডায়মন্ড যাবে না, আমরা দায়ী নই</li>
            <li>ডেলিভারি সাধারণত ৫-১০ মিনিটের মধ্যে</li>
            <li>সার্ভার সমস্যা থাকলে সর্বোচ্চ ২৪ ঘণ্টা লাগতে পারে</li>
        </ul>
    </div>
</div>

<div id="payment-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Complete Payment</h2>
            <button class="close-btn" onclick="closePaymentModal()">×</button>
        </div>
        <div class="payment-method">
            <img id="payment-method-img" src="" alt="">
            <h3 id="payment-method-name"></h3>
            <div class="payment-details">
                <p><strong>Send Money to:</strong> <span id="payment-number">01XXXXXXXXX</span></p>
                <p><strong>Amount:</strong> <span id="payment-amount">0৳</span></p>
                <p><strong>Product:</strong> <span id="payment-product">None</span></p>
            </div>
            <input type="text" id="transaction-id" class="tx-input" placeholder="Enter Transaction ID" required>
            <button class="confirm-btn" onclick="submitOrder()">CONFIRM PAYMENT</button>
        </div>
    </div>
</div>

<a href="https://t.me/JAHIDVAI12" class="support-btn" target="_blank">
    <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram">
</a>

<div class="info-circle">i</div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyBO1BfLJdUeX0KjvKvB2-MfvmoCIGj5gCI",
      authDomain: "ff-top-up-d630c.firebaseapp.com",
      projectId: "ff-top-up-d630c",
      storageBucket: "ff-top-up-d630c.firebasestorage.app",
      messagingSenderId: "337303890054",
      appId: "1:337303890054:web:fc9ef3d5dd45a8cdb34907",
      measurementId: "G-R63TLVTQQ1"
    };

    firebase.initializeApp(firebaseConfig);
    const analytics = firebase.analytics();
    const db = firebase.firestore();

    let selectedProduct = null;
    let selectedPayment = null;
    let products = [];

    function loadProducts() {
        db.collection("products").orderBy("price", "asc").onSnapshot(snapshot => {
            products = [];
            snapshot.forEach(doc => products.push({ id: doc.id, ...doc.data() }));
            renderProducts();
        });
    }

    function renderProducts() {
        const container = document.getElementById("packages-container");
        container.innerHTML = "";
        products.forEach(product => {
            const el = document.createElement("div");
            el.className = "pkg";
            el.innerHTML = `<div class="diamond">${product.name}</div><div class="price">${product.price}৳</div>`;
            el.onclick = () => selectPkg(el, product);
            container.appendChild(el);
        });
    }

    function selectPkg(el, product) {
        document.querySelectorAll('.pkg').forEach(p => p.classList.remove('selected'));
        el.classList.add('selected');
        selectedProduct = product;
    }

    function selectPayment(method) {
        document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
        event.currentTarget.classList.add('selected');
        selectedPayment = method;
    }

    // এখানে শুধু এই ফিচারটা যোগ করা হয়েছে
    function openPaymentModal() {
        if (!selectedProduct) return alert("দয়া করে একটি প্যাকেজ সিলেক্ট করুন!");
        if (!selectedPayment) return alert("পেমেন্ট মেথড সিলেক্ট করুন!");
        if (!document.getElementById("player-id").value.trim()) return alert("Player ID দিন!");

        const modal = document.getElementById("payment-modal");
        document.getElementById("payment-amount").textContent = selectedProduct.price + "৳";
        document.getElementById("payment-product").textContent = selectedProduct.name;

        // আইকন ও নাম সেট
        let imgSrc = "", methodName = "";
        if (selectedPayment === 'bkash') { imgSrc = "https://i.ibb.co.com/yyZJ7gT/bkash.png"; methodName = "bKash Payment"; }
        else if (selectedPayment === 'nagad') { imgSrc = "https://i.ibb.co.com/4pY7g7K/nagad.png"; methodName = "Nagad Payment"; }
        else if (selectedPayment === 'rocket') { imgSrc = "https://i.ibb.co.com/5Y7g7gK/rocket.png"; methodName = "Rocket Payment"; }
        document.getElementById("payment-method-img").src = imgSrc;
        document.getElementById("payment-method-name").textContent = methodName;

        // Firebase থেকে নাম্বার লোড (রিয়েল টাইম)
        db.collection("settings").doc("paymentNumbers").get().then(doc => {
            if (doc.exists) {
                const data = doc.data();
                const number = selectedPayment === 'bkash' ? data.bkash :
                              selectedPayment === 'nagad' ? data.nagad :
                              selectedPayment === 'rocket' ? data.rocket : null;
                document.getElementById("payment-number").textContent = number || "01XXXXXXXXX";
            } else {
                document.getElementById("payment-number").textContent = "01XXXXXXXXX";
            }
        }).catch(() => {
            document.getElementById("payment-number").textContent = "01XXXXXXXXX";
        });

        modal.style.display = "block";
    }

    function closePaymentModal() {
        document.getElementById("payment-modal").style.display = "none";
    }

    function submitOrder() {
        const txId = document.getElementById("transaction-id").value.trim();
        if (!txId) return alert("Transaction ID দিন!");

        const playerId = document.getElementById("player-id").value.trim();
        
        const order = {
            product: selectedProduct.name,
            price: selectedProduct.price,
            playerId: playerId,
            paymentMethod: selectedPayment,
            transactionId: txId,
            status: "pending",
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        db.collection("orders").add(order)
            .then(() => {
                alert("অর্ডার সফলভাবে জমা হয়েছে! শীঘ্রই ডেলিভারি দেওয়া হবে।");
                closePaymentModal();
                document.getElementById("transaction-id").value = "";
                document.querySelectorAll('.pkg').forEach(pkg => pkg.classList.remove('selected'));
                document.querySelectorAll('.payment-option').forEach(option => option.classList.remove('selected'));
                document.getElementById("player-id").value = "";
                selectedProduct = null;
                selectedPayment = null;
            })
            .catch(err => {
                console.error(err);
                alert("অর্ডার জমা দিতে সমস্যা হয়েছে, আবার চেষ্টা করুন।");
            });
    }

    window.onload = function() {
        loadProducts();
    };
</script>
    <footer style="text-align: center; padding: 15px 0; background-color: #f0f0f0; margin-top: 40px; font-size: 14px; color: #555;">
        © 2025 All rights reserved | Developed By MD ABDULLH KHAN
    </footer>
</body>
</html>